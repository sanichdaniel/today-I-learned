Virtual Memory
===

> 정의: 메모리를 효율적으로 관리하려고 메인 메모리를 추상화 시키는것

가상메모리는 프로세스를 실행할때 필요한 부분만 메모리에 올려 프로세스 전체가 메모리에 올라가지 않더라도 실행가능하게 하는 기법이다. 가상메모리는 각 프로세스에 하나의 크고 통합된 사적 주소공간을 제공한다. 

프로세스는 가상 주소를 사용하고, 실제 해당 주소에서 데이터를 읽고/쓸때만 물리 주소로 바꿔주면 된다.

MMU: cpu에 코드 실행시, 가상 메모리 접근이 필요할 때, 해당 주소를 물리 주소값으로 변환해주는 하드웨어 장치

주요한 기능 3가지
---

1. **기억장치의 효율적 관리**

     메모리를 하드디스크에 대한 캐시로 설정하여, 당장 사용하는 영역만 유지하고 쓰지 않는 데이터는 하드디스크로 옮긴 뒤, 필요할 때만 램에 데이터를 불러와 올리고 다시 사용하지 않으면 하드디스크로 내림으로써 램을 효과적으로 관리한다.
2. **메모리 관리의 단순화**  
    
    각 프로세스마다 가상메모리의 통일된 주소 공간을 배정할 수 있으므로 메모리 관리가 단순해진다.  
3. **메모리 용량 및 안정성 보장**  
   
   한정된 공간의 램이 아닌 거의 무한한 가상메모리 공간을 배정함으로써 프로세스들끼리 메모리 침범이 일어날 여지를 크게 줄인다

가상주소 방식
---

CPU는 가상주소(Virtual Address)를 생성해서 메모리에 접근한다. 메모리로 보내지기 전에 적절한 물리주소로 변환된다. 가상주소를 물리주소로 변환하는걸 주소번역이라고 한다. 

캐싱 도구로서의 VM
---

가상메모리는 **디스크**에 저장된 N개의 바이트 크게의 배열로 구성된다. 각 바이트는 특정한 가상주소를 가지며, 배열의 인덱스로 작용한다. 디스크 안의 배열 정보는 메인메모리에 캐시된다. 메로리 계층구조 안에 있는 캐시는 블록단위로 분할된다. 분할된 블록들은 가상페이지라 부른다. 

가상페이지의 집합은 3가지 부분집합으로 나뉘어진다.
* Unallocated: 아직 할당되지 않은 페이지
* Cached: 현재 물리 메모리에 캐시되어 할당된 페이지
* Uncahced: 물리 메로리에 캐시되지 않은 할당된 페이지

페이지 테이블
---

가상 페이지가 실제 메모리에 적재되었는지, 또 적재되지 않았는지를 구별할 수 없게 됩니다. 이때 DRAM에 **페이지 테이블** 이라고 페이지 테이블 앤트리의 (PTE) 배열이 있다. 페이지 테이블 에는 유효 비트 가 존재하여 어떤 페이지가 실제 물리 메모리에 적재되어 있는지를 표시해 주고 만약 실제 물리 메모리에 적재되지 않은 페이지는(페이지 오류) 그 페이지가 저장되어 있는 디스크 주소를 기록 해 두어 나중에 필요할 때 가져올 수 있게 해 줍니다.

메모리 관리를 위한 도구로서의 VM
---

